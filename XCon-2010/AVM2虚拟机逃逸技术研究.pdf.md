AVM2
/dgguai27 dgguai27@hotmail.com  


   AVM2      


 HLL
 HLL
.NET CLRAVM2JVM...
 




   


 :AVM2
 
FlashSky AVM2--""Flash
 



AVM2""

AVM2
AVM2 ShellCode ShellCode ShellCodeDEP 
: AVM2
:


   AVM2      

AVM2
 ABC  AVM2  ""

ABC
ABC:

ABC

ABC
 Security Sandbox
   

AVM2

Virtual RegistersOprand StackScope Stack
AVM2
 
Atom

""

IE/Office: Flash9x.ocxFlash10x.ocx IENPSWF32.dll Adobe Reader/Acrobat: Authplay.dll


 ABC    ""

ABC

Flash9fMask , 

AVM2 
uninit use after free...

Flash9e.ocxMask:


  

""
AVM2IE 


   AVM2      


 ABCI  ABCII  ""  

ABCI
AVM2 ABC1 ShellCode 

ABCI

ABCI
CVE-2007-0071
 Dereference Null

 Mark Dowd

ABCII
AVM2ABC 2  ShellCode

ABCII

ABCII
CVE-2009-1866
 
25 81 10: push short 25 81 10: push short C7: multiply_i 30: pushscope 5D 01: findpropstrict
 
JS HeapSprayAS HeapSpray

demo1

""
AVM2 JIT X86AVM2 ShellCode DEP

""

""
 AVM2JIT  IE8ActiveX


Demo2


AVM2ABC 2  ShellCodeDEP




CVE-2010-1297
 JIT
newfunction 40 4e -> 40
 BIB.dll+Ret-to-libc

demo3


   AVM2      


Flash Player DEP Microsoft EMET IE8 windows 7 Sandboxie 


   AVM2      


 Tamarin  HLLWin7Mac OS  Flash



