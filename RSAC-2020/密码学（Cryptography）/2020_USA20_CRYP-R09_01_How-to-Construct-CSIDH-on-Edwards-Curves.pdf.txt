SESSION ID: CRYP-R09
Mathematical Advances in Cryptography

Tomoki Moriya
How to Construct CSIDH on Edwards Curves The University of Tokyo

#RSAC

#RSAC
Main result
We extend a CSIDH algorithm to that on Edwards curves.

CSIDH

Montgomery curves (-coordinate) Edwards curves (-coordinate)

2

#RSAC
Contents
1. Isogeny-based cryptography 2. CSIDH 3. Construct CSIDH on Edwards curves 4. Computational complexity 5. Conclusion
3

#RSAC
1. Isogeny-based cryptography

#RSAC
Currently public key cryptography
RSA crypto. [Rivest, Shamir, Adleman (Communications of the ACM 1978)] Elliptic curve crypto. [Miller (CRYPTO 1985)], [Koblitz (Mathematics of Computation 1987)] They are broken in polynomial time by using quantum computers.
[Shor (FOCS 1994)]
We need new cryptosystems: post-quantum cryptography.
5

#RSAC
Candidates for post-quantum cryptography
Isogeny-based cryptography Lattice-based cryptography Multivariate cryptography Code-based cryptography Hash-based signature etc...
6

#RSAC
Main property of isogeny-based cryptography
Based on Isogeny Problem Using elliptic curves Main merit: key lengths are short. Main demerit: it takes more time to execute protocols.
7

#RSAC
Elliptic curves and isogenies (1/3)
Elliptic curves
Elliptic curves are smooth algebraic curves with genus 1. Elliptic curves have abelian group structures.
8

#RSAC
Elliptic curves and isogenies (2/3)
Montgomery curves 2 = 3 + 2 +  (2  4)
Edwards curves 2 + 2 = 1 + 22 (  0, 1)
9

#RSAC
Elliptic curves and isogenies (3/3)
Isogenies
An isogeny is a morphism between elliptic curves which is also a group morphism on elliptic curves.

Morphisms

Isogeny Group morphisms

10

#RSAC
Velu formulas and Isogeny Problem (1/3)
Velu formulas [Velu (CR Acad. Sci. 1971)]
Input : an elliptic curve  and a finite subgroup  of  Output : an elliptic curve /
and an isogeny :   / satisfying ker  = 

(, )

(/, )

11

#RSAC
Velu formulas and Isogeny Problem (2/3)
Isogeny Problem
From two given isogenious elliptic curves  and , compute an isogeny :   F

 or 

(, /)

12

#RSAC
Velu formulas and Isogeny Problem (3/3)

Velu formulas (easy)

(, )

(/, )

Isogeny Problem (difficult)

 or 

(, /)

13

#RSAC
2. CSIDH

#RSAC
CSIDH key exchange (1/2)

CSIDH key exchange [Castryck et al. (ASIACRYPT 2018)]
CSIDH is an isogeny-based key exchange protocol based on a group action of a finite abelian group to a set of isomorphism classes of supersingular elliptic curves.

0

 0

 0

][ 0: 2 = 3 + 2 + 

15

#RSAC
CSIDH key exchange (2/2)

CSIDH key exchange [Castryck et al. (ASIACRYPT 2018)]
 A group action of an ideal class group of [ -] [Waterhouse (1969)]  This group is a finite abelian group, and a set of equivalent classes
of ideals of [ -] .

0

 0

 0

][ 0: 2 = 3 + 2 + 

16

#RSAC
An algorithm of CSIDH (1/2)
How do we compute an elliptic curve  0?
 Let a prime  satisfy  = 41   - 1, where the 1,  ,  are distinct small odd primes.
 A group element  satisfies  = [1]1  [], where  = , - - 1 , []-1 = , - + 1 , and 1, ... ,  are small integers. (let max absolute value of them be .)
 Let secret keys (1, ... , ).  We only consider actions of  and []-1.
17

#RSAC
An algorithm of CSIDH (2/2)
How do we compute actions of  and []-1?
   = /  , and  -1 = /  . (Waterhouse)     a subgroup of  generated by a point of order 
contained in ker  - 1 , where  is -Frobenius map ,   (, ).     a subgroup of  generated by a point of order  contained in ker  + 1 .
Velu formulas
18

#RSAC
CSIDH on Montgomery curves (1/2)

Montgomery curves : 2 = 3 + 2 + 

-coordinate [Montgomery (Mathematics of Computation 1987)] [Costello et al.
(ASIACRYPT 2017)]

   : random    ker  - 1 or ker  + 1 , where   = .

()2 = 3 + 2 +  : square    ker  - 1 .

()2 = 3 + 2 +  : not square    ker  + 1 .

p+1 



is

a

point

of

order



with

high

probability

(1

-

1/

).

 is unique up to -isomorphism.

19

CSIDH on Montgomery curves (2/2)

  ker( - 1)

  2 : square

  : random

+1 

times

#RSAC
  Output : coefficient
Velu formulas

  2 : not square   ker( + 1)

 -1 Output : coefficient

20

#RSAC
3. Construct CSIDH on Edwards curves

#RSAC
CSIDH on Edwards curves
Edwards curves : 2 + 2 = 1 + 22 -coordinate :  ,  = 22 [Farashahi et al. (ACISP 2017)][Kim et al. (ASIACRYPT 2019)]    : random  sometimes   ker  - 1 and   ker  + 1 , where   = . There is no proof that  is unique up to -isomorphism.
22

#RSAC
Main theorems (1/3)
Theorem 1,3

  : square

 2 : square  2 : not square

    2  ker  + 1    1/ 2  ker  - 1

In

each

case,

p+1 4



is

a

point

of

order



with

high

probability

(1

-

1/

).

23

#RSAC
Main theorems (2/3)
Theorem 2

  : square

 2 : square  2 : not square

Same probability

24

#RSAC
Main theorems (3/3)
Theorem 4

: 

Coefficients of Edwards curves 

-isomorphism classes

25

CSIDH on Edwards curves

  ker( - 1)

(2) : not square   : random
   2

+1 4

times

(2) : square

  ker( + 1)

26

#RSAC
  Output : coefficient
Velu formulas
 -1 Output : coefficient

#RSAC
4. Computational complexity

#RSAC
Theoretical comparing computational complexity (1/2)

Montgomery

Edwards

Sampling points
 Compute 3 + 2 +  3 + 1 + 2

Sampling points
 Compute 2 1  Compute  2 4 + 1 + 5

1 + 1 + 3

Scalar multiplication

Scalar multiplication



Compute  =

+1 S





Compute  =

+1 4S



-8 - 3 - 9

28

#RSAC
Theoretical comparing computational complexity (2/2)

Montgomery
Sampling points and scalar multiplication

Edwards
Sampling points and scalar multiplication

-3

-

1 2



-

3 2



(at

least)

Compute isogenies [Meyer et al. (INDOCRYPT 2018)]
 Compute   / (6 + 2) + 8 + (4 + 8) two  th-power

Compute isogenies [Kim et al. (ASIACRYPT 2019)]
 Compute   / (6 + 2) + 8 + (4 + 6) two  th-power

-2
29

#RSAC
Implementation

Based on the original paper of CSIDH,  was chosen as  = 4  1  74 - 1, where 1,  , 73 were the smallest distinct odd primes, and 74 = 587. Let  = 5.

We measured the average computational complexity by executing it 50000 times.

   Total

Montgomery 328,195 116,915 332,822 438,368

1 = 0.8, 1 = 0.05
30

Edwards 328,055 116,857 331,844 438,133

#RSAC
5. Conclusion

#RSAC
Conclusion
We proposed a new CSIDH algorithm on Edwards curves. This algorithm is as fast as (a little bit faster than) that on Montgomery curves.
32

#RSAC
Thank you for listening!

