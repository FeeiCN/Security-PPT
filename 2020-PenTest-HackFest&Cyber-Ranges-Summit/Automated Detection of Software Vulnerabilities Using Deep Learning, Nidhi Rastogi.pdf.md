Pen Test HackFest & Cyber Ranges Summit
Live Online

Nidhi Rastogi Research Scientist, Rensselaer Polytechnic Institute, Troy, NY

iamnidhirastogi

nidhirastogi

Summit: Jun 4-5 | Training: Jun 8-13

sans.org/hackfest

1

Automated detection of software vulnerabilities using
Deep learning
#SANSHackFest
2

What is this talk about
 Find Software vulnerabilities using Deep Learning
 both for profit and pleasure!
 Run through the end-2-end process  Access to github code
 try it out for yourself
3

Software Vulnerability Detection
 Vulnerabilities pose serious risks of exploit
 System compromise  Information leaks  DoS
#SANSHackFest
4

Software Vulnerability Detection
Increasing number of software vulnerabilities
 CVE count increasing every year
Compiled in 2018
#SANSHackFest
5

Machine Learning approaches
(+)detect vulnerabilities using patterns learned from analyst-defined feature representations of vulnerabilities
(-)Security experts have to define vulnerability features
 function length, nesting depth, string entropy, n-grams and suffix trees, etc.
6

Machine Learning approaches
Cat Classifier
Features  Ears  Color  Shape  Eye shape  Eye color

70% Cats

ML Model

30% Others

7

Machine Learning approaches
(+)detect vulnerabilities using patterns learned from analyst-defined feature representations of vulnerabilities
(-)Security experts have to define vulnerability features  Human labor intensive  High False negative rates
8

Deep Learning based approaches
 Automatic Discovery of Features
 Not deciding what features should be selected for the deep learning model
 Alleviate human expert involvement
9

Deep Learning Approaches
Cat Classifier
Features  Ears  Color  Shape  Eye shape  Eye color

70% Cats

NN Model

30% Others

10

Goal : Automatically detect software vulnerabilities using Deep Learning
11

Specifically...
 Detect buffer overflows  resource management errors
 Deep Learning Model (BLSTM) based on VulDeePecker*
*https://www.ndss-symposium.org/wp-content/uploads/2018/02/ndss2018_03A-2_Li_paper.pdf
12

DL Modeling entails...
1. Preparing the Data
2. Choosing the Neural Network
3. Running the model
4. Analyzing Results
13

Data Preparation...
1. Preparing software programs for DL model
 Identifying level of granularity of the code or the model
 Location can be identified in the program

1. Preparing the Data

2. Choosing NN

3. Running the model

4. Analyzing Results

14

Data Preparation...
1. Preparing software programs for DL model
 Identifying level of granularity of the code or the model
 Location can be identified in the program
2. Convert Programs to Code Gadget
lines of code semantically related to each other Can be vectorized as i/p to NN model.

1. Preparing the Data

2. Choosing NN

3. Running the model

4. Analyzing Results

15

Neural Network Model
Bidirectional LSTM Model, because...  Supervised Model  used where the learning problem is sequential  you feed the learning algorithm with the original data
 once from beginning to the end AND  once from end to beginning
 Training: Randomly choose 80% of programs  Testing : Rest of the 20% programs

1. Preparing the Data

2. Choosing NN

3. Running the model

4. Analyzing Results

16

bilstm rnn model
bilstm has two networks:
1. Past information in forward direction 2. Future in the reverse direction

1. Preparing the Data

2. Choosing NN

3. Running the model

4. Analyzing Results

17

Running bilstm rnn model
1. Input -> Code gadgets 2. Model bilstm 3. Output -> 1(vulnerable) / 0 (not vulnerable)

1. Preparing the Data

2. Choosing NN

3. Running the model

4. Analyzing Results

18

Analyzing Results
1. Confusion Matrix - TP, FP, TN, FN 2. Accuracy, Precision, Recall 3. RoC, AUC 4. ...

1. Preparing the Data

2. Choosing NN

3. Running the model

4. Analyzing Results

19

Experiments
20

Preparing the data (input)
2 datasets are available(extracted from NVD)
 Buffer Error Vulnerability (CWE-119)
 520 Open source software programs  8,122 test cases
 Resource Management Vulnerability (CWE-399)
 320 Open Source Software Programs
 1,729 test cases
21

Prepare the Environment (macOS)
1. pip install pandas gensim keras tensorflow sklearn 2. Install git 3. Run the following command in terminal: git clone https://github.com/nidhirastogi/Deep-Learning-BasedSystem-for -Automatic-Detection-of-Software-Vulnerabilities.git 4. Extract the 2 Datasets : cwe119 and cwe399
22

Generating code gadgets
23

Training the model
1. python vuldeepecker_train.py /dataset/cwe119.txt
24

Model Prediction
 python vuldeepecker_predict.py cwe119 cwe119_cgd_gadget_vectors.pkl
25

Run implementation video
26

Thank You! Questions?
27

