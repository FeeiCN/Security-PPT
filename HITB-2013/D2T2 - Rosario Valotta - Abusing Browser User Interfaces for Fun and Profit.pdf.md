ABUSINGBROWSERSU SFOERRFIUNNTERFACES
&PROFIT

HELLO
MY NAMRE ISosario
sites.google.com/site/tentacoloviola/

SOCIALLYENGINEEREDMA
2012200K NEW MALWARE SAMPLES EVERY DAY
FACTS 1.5+ BILLIONS MALWARE ATTACKS ORIGINATED FROM THE WEB
MOSTLY ORIGINATED BY USER INITIATED DOWNLOADS

USERSASKFOR
 GUIDANCE WHILE SURFING THE WEB
 PROTECTION FROM MALICIOUS SITES
 RELIABLE BROWSER SECURITY MECHANISMS

VENDORSREPLIES

ENHANCED MEMORY PROTECTION TECHNOLOGIES FOR PROTECTING AGAINST EXPLOITS AND DRIVEBY DOWNLOADS (ASLR, DEP, GS, ETC)

EMBEDDED SECURITY FITERS AGAINST WEB ATTACKS (XSS FILTER, ANTI FRAMING/ CLICKJACKING, ETC)

MALWARE/PHISHING RECOGNITION TECHNOLOGIES (SAFE BROWSING, SMARTSCREEN FILTER, ETC)

TRUSTED AND RECOGNIZABLE USER INTERFACES TO HELP USERS IN MAKING AWARE CHOICES WHILE SURFING THE WEB

THIS IS CHROME

THIS IS CONTENT

WHICHISCHROME?
PICT UREI N PICT URE ATTA

URL OBFUSCATION FLAWS
 EXPLOIT A DESIGN FLAW IN BROWSERS THAT ARE NOT ABLE TO RELIABLY RENDER THE URL REQUIRED BY THE USER
 URL FORMAT FOLLOWS THE GENERAL PATTERN http:// username:password@mysite.com WITH OPTIONAL password FIELD

 http://www.bankofamerica.com&service=...@174.120.41.176/~inferno/eRxApIlSoiEtsA/

obfusurl/index.htm

WARNI

NG

DISABLES RESOLUTION FOR URLS WITH EMBEDDED CREDENTIALS
RENDERS PAGE AND STRIPS CREDENTIALS FROM THE URL AND REVEALING TRUE NATURE OF THE DOMAIN

DOWNLOAD DIALOG SPOO STILL WORKS ON IE9, CHROME 25 AND

 VICTIM VISITS ROGUE

FIREFOX 19!

WEBSITE

 WEBSITE IMMEDIATELY SPAWNS A NEW NAVIGATION WINDOW LINKING TO A BENIGN WEBPAGE

 ROGUE WEBSITE SETS THE NEW NAVIGATION WINDOW URL TO A RESOURCE SERVED WITH Content-Disposition: attachment HEADER
 A DOWNLOAD NOTIFICATION BAR/DIALOG APPEARS IN THE CONTEXT OF THE NEW NAVIGATION WINDOW

http://lcamtuf.coredump.cx/fldl/

BROWSERSECURITYN

BROWSERSECURITYN

MODALNOTIFICATIONS
STRONG VISUAL CONTRAST  GRAB USER ATTENTOIOS NGE텻BELROACTEKDWORKFLOW BROWSER GENERATED

 IMPORTANT NOTIFICATIONS ONLY
 NOT STRICTLY PART OF CHROME
 DEFAULT ANWSER PROBLEM

 TRIGGERED IN SEVERAL SCENARIOS
 SOMETIMES CAN BE VERY ANNOYING
 DEFAULT ANWSER PROBLEM

MODELESSNOTIFICATIONS
 DESIGNED TO INFORM USER WITHOUT INTERRUPTING  STAY IN CONTEXT OF THE NAVIGATION WINDOW  CHROME NOT DOM

FILEDOWNLO ADING PLUGINSACTI VATION

HTML5APIS

MODALTOMODELESSSHIFT
MODELESMSODELESMSODELESMSIXED MODAL MODELESMSODELESMSODELESMSODAL MODAL MODAL MODAL MODAL MODAL MODAL
EXTENSIONS/ADDONS
MODELESMSODELESMSODELEMSSODELESMSODAL

4PROBLEMSABOUTMODEL

NOTIFICATIONSINBACKGRO
SCENARIO:
1. USER BROWSES ON ATTACKER WEBASLITTTELE BIT OF JS MAGIC 2. WEB PAGE SPAWNS A POPUP WINDOIWSWORREKQIUNIREEVDERFYORBRTOHWISSTEOR. 3. POPUP IS OPENED ON THE BACKGRbOluUr()NDODES(PN'TOWPOURNK DER) 4. ON WINDOWS 7/8 THE POPUNDER ISPIMRMPOLEPEEMRREELNYLTOAYTNIUOSNONSMN.EOTICED
JSPOPUNDER PROJECT
5. POPUNDER INITIATES A DOWNLOADECNRAOBSLSEBSRPOOWPSUENRDERS IN 6. MODELESS NOTIFICATION IS TRIGGEERNVEIRDON(MHEINDTDS.EN FROM USER
7. POPUNDER TAB DOESN'T BLINK TO GIVE EVIDENCE OF A PEND

KEYBOARDSHORTCUTS
 ARE AVAILABLE FOR ACTIVATING ACTIONS ON NOTIFICATION B  IE ALLOWS THIS FOR FILE DOWNLOAD NOTIFICATIONS
ALT +R  ALT +S 
 IE & FF ALLOW THIS FOR HTML5 API NOTIFICALATT+IOO NS

ALT + O

ALT +A  ALT + O

 NAVIGATION WINDOW NEEDS TO BE FOCUSED FOR USING SHO

USINGTABINNOTIFICATION
SOME BROWSERS ALLOW USING TAB KEY TO NAVIGATE
 IE ALLOWS THIS FOR FILE DOWNLOAD NOTIFICATION
 CHROME SKIPS THE FILE OPENING BUTTON NOTIFICATION BAR IS PART OF CHROME: NO NAVIGATION USING D

BOUNDTONAVIGATIONWIN
AS THEY ARE BUILT IN CHROME, NOTIFICATION BARS CAN BE:

ATTACKSCENARIO#1 9 -10
1. USER BROWSES ON ATTACKER WEBSITE 2. WEB PAGE SPAWNS A POPUNDER WINDOW 3. ON WINDOWS 7/8 THE POPUNDER IS MERELY
UNNOTICED 4. POPUNDER INITIATES A DOWNLOAD OF A .EXE
FILE 5. MODELESS NOTIFICATION IS TRIGGERED
(HIDDEN FROM USER VIEW) 6. POPUNDER TAB DOESN'T BLINK TO GIVE
EVIDENCE OF A PENDING NOTIFICATION 7. AFTER NOTIFICATION IS READY, POPUNDER IS
STILL IN BACKGROUND BUT HAS THE FOCUS! 8. EVERY KEYBOARD INPUT WILL BE DIRECTED TO
THE POPUNDER... 9. USER ENTERS "TAB" + "R" or "SPACE" or "ENTER"

ATTACKSCENARIO#1 - 9B-10ON
 IN IE9 OPENING POPUNDER WINDOW USING:
  
  <meta  http--equiv="X--UA--Compatible"  content="IE=EmulateIE7"  />  
  
WILL BRING THE FOCUS OF THE POPUNDER DIRECTLY ON THE NOTIFICATION BAR
 THIS MEANS YOU CAN TRIGGER CODE EXECUTION BY JUST TYPING A KEY:
 R key (key changes according to OS language)  SPACE key  ENTER key

LIMITATIONSFORATTACK#1

MALICIOUSDOWNLOADPRO
BLOCKING ACCESS TO MALICIOUS URLS&FILES BEFORE FUNCTIONAL COMPONENTS:
3 2 1

IMPLEMENTATIONS

SAFEBROWSING

SMARTSCREENFILTER

              IE  

EFFECTIVENESS

MALWARE URL RESPONSE TIME

CHARTS FROM NSS LABS REPORT 2012

SMARTSCREENFILTER     <App>

        <FName>U2FtZUdhbWUuZXhl</FName>
INPUTI:P  URL  FILE HASH (SHA256)          <FHash>d3ff5939726c9f8fa6e514fb65eb470   a1f9ec7a65b2706732a03749226c25

FILENAME (BASE64)

  20</FHash>         <Sig>0</Sig>

 SIGNING CERTIFICATE (if available)         <Sz>45056</Sz>         <M>1</M>

        <SR>100</SR>

    </App>

OUTPUT:



SUCCEDE

EBDL ACKLIST

BAR COLOR CHANGES ACCORDING TO THE REDEPUTATION

SIGNING CERTIFICATE + CHECK RESULT

FAILURE

(NOTSO)SMARTSCREENFIL

REPUTATION CHECK IS NOT 100% RELIABLE MORE THAN 20% SAMPLES ON http://minotauranalysis.com/ exetweet/default.aspx WILL PASS
TBHURYOAUNGHEV CERTIFICATE AND GAIN REPUTATION! NEWLY PUBLISHED EXECUTABLES SIGNED WITH AN EV CERTIFICATE WILL IMMEDIATELY ESTABLISH A GOOD REPUTATION EVEN IF NO PRIOR REPUTATION EXISTS

RESPONSE TIME FOR CATCHING NEW EXECUTABLE SAMPLES ALLOWS FOR EASY BYPASS IN THE FIRST PUBLISHING DAYS
INTERNET CONNECTION NEEDED FOR PERFORMING THE CHECK (more on this later...)

ATTACKSCENARIO#1ONST
MITM SCENARIO
1
X
2
1. ATTACKER SETS UP A FREE ACCESS POIN 2. BLOCKS COMMUNICATIONS TO SMARTSCR 3. RESULT IS:
4. TRICK VICTIM TO TYPE "R"/ "Enter" / "Space 5. ARBITRARY CODE EXECUTION!

USERACCESSCONTROL
ONLY TRIGGERED WHEN ADMINITRATIVE PRIVILEGES AR YOU CANNOT BYPASS THAT. FULL STOP. DO YOU REALLY NEED THAT FOR CAUSING SERIOUS TR

LIMITATIONSFORATTACK#1
X

ATTACKSCENTAIMIRNGI/OPO#SIT2IONATTACK
DYNAMIC WINDOW OVERLAY
1. USER BROWSES ON ATTACKER WEBSITE 2. WEB PAGE SPAWNS A POPUNDER WINDOW AT SOME GIVEN
COORDINATES 3. POPUNDER INITIATES A DOWNLOAD OF A .EXE FILE 4. MODELESS NOTIFICATION IS TRIGGERED (HIDDEN FROM
USER VIEW) 5. POPUNDER TAB DOESN'T BLINK TO GIVE EVIDENCE OF A
PENDING NOTIFICATION 6. ATTACKER TRICKS VICTIM TO CLICK ON A GIVEN LINK/
BUTTON 7. PAGE IS LISTENING ON MOUSE MOVES 8. AS SOON AS THE MOUSE IS HOVERING ON THE BUTTON,
WINDOW IS CLOSED 9. IF TIMING IS APPROPRIATE THERE ARE GOOD CHANCES OF
VICTIM CLICKING ON THE UNDERLYING POPUNDER

ATTACKSCENARIO#2RELOA

 EVERY TIME A FILE IS DOWNLOADED FROM THE WEB THE OS

ADDS A ZONE INFORMATION FILE TO THE DISK

 ZONE INFORMATION FILE IS WRITTEN IN AN ASD (alternate data

stream)

 IT CONTAINS A REFERENCE TO THE SECURITY ZONE THE FILE



WAS DOWNLOADED FROM LAUNCHING AN UNKNOWN

(.eE.XgE. INTE톀 NAESTM) ARTSCREEN

CHECK

IS

FILE DOWNLOADED FROM THE

PERFORMED (BUT YOU

WEB WILL PROMPT A

ALREADY KNOW HOW TO

CONFIRMATION DIALOG, NOT

BYPASS IT)

BYPASSABLE

 NO FURTHER DIALOGS ARE

DISPLAYED

 CODE EXECUTION!

ATTACKSCENARIO#2.b
DYNAMIC WINDOW OVERLAY
1. USER BROWSES ON ATTACKER WEBSITE 2. WEB PAGE SPAWNS A POPUNDER WINDOW AT SOME
GIVEN COORDINATES 3. POPUNDER LOADS A WEBPAGE REQUIRING SOME
PRIVILEGES (e.g. YOUR POSITION) 4. MODELESS NOTIFICATION IS SHOWN (HIDDEN FROM
USER VIEW) 5. POPUNDER TAB DOESN'T BLINK TO GIVE EVIDENCE OF A
PENDING NOTIFICATION 6. ATTACKER TRICKS VICTIM TO CLICK ON A GIVEN LINK/
BUTTON 7. PAGE IS LISTENING ON MOUSE MOVES 8. AS SOON AS THE MOUSE IS HOVERING ON THE BUTTON,
WINDOW IS CLOSED 9. IF TIMING IS APPROPRIATE THERE GOOD CHANCES THE

ATTACKSCENARIO#2.c
DYNAMIC WINDOW OVERLAY
1. USER BROWSES ON ATTACKER WEBSITE 2. WEB PAGE SPAWNS A POPUNDER WINDOW AT SOME
GIVEN COORDINATES 3. POPUNDER LOADS A WEBPAGE SERVED WITH X-FRAME-
OPTIONS (e.g. TWITTER) 4. ATTACKER TRICKS VICTIM TO CLICK ON A GIVEN LINK/
BUTTON 5. PAGE IS LISTENING ON MOUSE MOVES 6. AS SOON AS THE MOUSE IS HOVERING ON THE BUTTON,
WINDOW IS CLOSED 7. IF TIMING IS APPROPRIATE THERE GOOD CHANCES THE
VICTIM CLICKS ON THE UNDERLYING POPUNDER

SOME PROPOSALS
1. NOTIFICATIONS ON BACKGROUND WINDOWS ARE USELESS (AT BEST). LET THE NOTIFICATION POPS-UP AFTER SOME SECONDS SINCE THE WINDOW HAS REGAINED FOCUS
2. DISABLE TAB KEY IN THE NOTIFICATION BAR, JUST USE THE MOUSE. IF YOU ARE CONCERNED ABOUT ACCESSIBILITY ENABLE COMPLEX KEYBOARD SHORTCUTS IN ORDER TO LIMIT THE CHANCE OF BEING SOCIAL ENGINEREED
3. SOME SENSITIVE NOTIFICATIONS (E.G. FILE DOWNLOADING) SHOULD BE EVER KEPT IN A STATIC FRAME OF THE CHROME, NOT BOUND TO NAVIGATION WINDOW
4. BROWSER INITIATED SWITCHES BETWEEN WINDOWS OF DIFFERENT DOMAINS SHOULD BE COMBINED WITH A GRAPHICAL EFFECT (e.g. fading, etc) IN ORDER TO GIVE USERS ADEQUATE REACTION TIME

CONCLUSIONS
1.THE BROWSERS SHIFT FROM MODAL TO MODELESS NOTIFICATIONS IS STILL NOT MATURE
2.IMPLEMENTATIONS ARE NOT SECURE ENOUGH TO PROTECT USERS SAFETY: AL LEAST TWO TECHNIQUES ALLOW FOR STEALTH REMOTE CODE EXECUTION
3.WHY TRING TO BUILD COMPLEX AND UNRELIABLE EXPLOITS IF GETTING CODE

THAYNOU K
valotta.rosario@gmail.com @tentacolo_Viola sites.google.com/site/tentacoloviola/

