



cirrusgate.com

1

         
cirrusgate.com

   
2



cirrusgate.com

3

nfcxhxdttc.cn

cirrusgate.com

4

nfcxhxdttc.cn
2015 6 21 -   DNS    

cirrusgate.com

5

Conficker
200811

.A
  250 /  5 TLD
 

.D
  50,000 /  110 TLD   500 /

cirrusgate.com

6





nfcxhxdttc.cn

DNS  

192.168.20.157

  Conficker  

CSIRT  

 Z

cirrusgate.com

7













 



 





cirrusgate.com

8


Domain Name Object nfcxhxdttc.cn



cirrusgate.com

9

      DGA   C&C  

Cryptolocker
qnqgkouekldintl.net eppgftqgclxcnpk.biz
rosfjxmtnwxynff.ru fqrfedivfwsseom.org spvkivucmxqfcee.co.uk grukdbqeexlychh.info tqxjhfmrpjlvjih.com hswjckithjgpays.net ugywcyndspvscaq.biz
vtxlfehkkmeikgx.ru vhbvbifsvbqjcws.org wuakenyanxyybtr.co.uk wiebagnbucjpceq.info
cirrusgate.com

Gameover Zeus
il6ytoywktgp8xv3ve1j3av1v.net t5rr78orl5hw12yheez187kkui.com
9x8t00yk5xhfaw0s0a149r2xk.biz knvqi4fh8yyx13dja5p10mwpww.com
gcsqzp1nybe4ssw2hzrwructz.com 1qtkve01cjzsju1hvcsi9d4mmvv.org
tqms0g1rr25lmsf61hhseu3jc.com ch9quv19fwudc1l4755d3anvbg.org 4czl1m1iarfcz1o4ssl6cz3eb6.biz
dvs9mfhuhphv1jxw4ovdwqv7r.net dbz9th1udt7i310igjatir5c85.com
e5pfzy16huhygttl5w0sj3wky.net 2dn4pf1fqa6ivsqm2vx19j9knh.biz
10

DNS          


16-0.19-a3000000.10082.1644.976.3ea3.410.0.6bq4kprjdsbmpkj2kvtanwl1db.avts.mcafee.com
FrameworkPOS
[Unique ID].beacon.[Encoded IP].[Encoded Hostname].[C&C Server].[TLD] [Unique ID].alert.[Encoded App Name].[C&C Server].[TLD] [Unique ID].[Encoded Credit Card Data].[Encoded Credit Card Data].[C&C Server].[TLD]


dacsjmxlt7p53j8p775hc.nam9hi6nqcc4j6e6wo7d25.56.85h5.com onmg5rfhnrvam7554qxue5p55n.9i9jpu9uc96ovgbpebog8up69a.56.nbgtr.com x8p3ux2hao7ngoi9vrinr445k8.l2os599igokrhlire5uiofx2oa.56.vcxde.com

cirrusgate.com

11

Domain Shadowing
   

cirrusgate.com

12



cirrusgate.com

13

  TXT        payload

Updating Of Malicious Code Patterns Using Public DNS Servers
United States Patent US8171467

cirrusgate.com

14




         
cirrusgate.com


         
15



     

cirrusgate.com

16

 ?

cirrusgate.com

17

cirrusgate.com


14 %
28 %
Bit.ly 
18

 DNS







cirrusgate.com

19



 N-grams  Random Forest  Levenshtein Distance  

 C4.5  Adaboosting  Word Segmentation

cirrusgate.com

20



4000
24
cirrusgate.com

60

21

 

cirrusgate.com

22



4000 
24

60 


~100


cirrusgate.com

23

  DNS       payload

 TXT                  payload     TXT  100  

cirrusgate.com

24





 >20/



      SIEM NGFW A V Sandbo x          



   

cirrusgate.com

25



        360 51 kaixin001                xshzzxx.net   

cirrusgate.com

26



login.live.com.nsatc.net

cdn.marketplacecontent.windowsphone.com.nsatc.net www.update.microsoft.com.nsatc.net login.passport.com.nsatc.net
v4windowsupdate.microsoft.nsatc.net eds-anon.xboxlive.com.nsatc.net r.msn.com.nsatc.net
clientconfig.microsoftonline-p.net.nsatc.net advertising.microsoft.com.nsatc.net mobileads.msn.com.nsatc.net

cirrusgate.com

27

    DGA        

statement

fraud

mobile

account secure

transaction live
report
app

update + PayPal +

c1ient

transfer

login

manager

checking

service apis

sh0p content

feedback

customer

cirrusgate.com

28

...

         

cirrusgate.com

29

