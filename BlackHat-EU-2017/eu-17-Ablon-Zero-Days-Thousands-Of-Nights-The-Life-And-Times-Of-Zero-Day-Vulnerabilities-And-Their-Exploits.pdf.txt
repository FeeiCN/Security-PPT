Zero Days, Thousands of Nights
The life and times of zero-day vulnerabilities and their exploits
Lillian Ablon
lablon@rand.org @lilyablon

Are zero-day vulnerabilities a zero-sum game?
· Zero-day vulnerabilities can be very useful to those testing defenses or planning offensive operations
· They can also lead to unsecure platforms and increase risk
Retain or disclose ?
Ablon - 2

Retain or disclose ?

Should a government keep zero-days secret?

Should a government disclose zero-days?

Ablon - 3

The decision calculus is complicated:
Ablon - 4

The decision calculus is complicated: there are many equities to consider
· Defense
· Intelligence, law enforcement, and operational
· Commercial
· International partnership
Ablon - 5

The decision calculus is complicated: there are many variables in play
· The product that the vulnerability is in · The threat actor that might take advantage of the
vulnerability · The use of the vulnerability in operations · The vulnerability itself · Other information

These variables are a few of those that are examined as part of the U.S. Vulnerabilities Equities Process

Ablon - 6

The decision calculus is complicated: there are many variables in play
· The product that the vulnerability is in · The threat actor that might take advantage of the
vulnerability · The use of the vulnerability in operations · The vulnerability itself · Other information

These variables are a few of those that are examined as part of the U.S. Vulnerabilities Equities Process

Ablon - 7

We focus on characteristics of the vulnerabilities

Life Status
Who knows about the vulnerability?

Longevity Collision Rate

How long will the vulnerability remain publicly unknown?

How many vulns get independently rediscovered and publicly disclosed?

Ablon - 8

· Research Focus · Quick Dive into the Data · Analysis & Findings · Implications & Recommendations
Ablon - 9

Various groups search for vulnerabilities
PRIVATE PUBLIC
Ablon - 10

Private groups consist of `good' and `bad' actors

US
THEM
Adversaries of US, Malicious Actors

PUBLIC
Includes: - Companies / vendors looking for zero-
day vulnerabilities in their own products and products of their customers - Bug Hunters looking for zero-day vulnerabilities, often for bug bounty payouts - Zero-day subscription feed businesses - Other organizations like Project Zero
Ablon - 11

Sometimes different groups find the same vuln.

US THEM

PUBLIC

Ablon - 12

Disclosure affects each camp differently

Vulnerabilities known to both US and THEM
disclosure by US may strengthen our defensive posture

US THEM

PUBLIC

Ablon - 13

Disclosure affects each camp differently
Vulnerabilities known only to US, and not to THEM:
US

disclosure by US may hinder our offensive posture

PUBLIC

THEM

Ablon - 14

Disclosure affects each camp differently

US THEM

PUBLIC

Ablon - 15

Large overlap: We're vulnerable! Disclose all!

US THEM

PUBLIC

Ablon - 16

Small overlap: We're (mostly) secure; retain!

US THEM

PUBLIC

Ablon - 17

What about the overlap between us and them?

US THEM

PUBLIC

Ablon - 18

What about the overlap between us and them?

Vulnerabilities known to BUSBY; not in Public Knowledge

BUSBY is our proxy

Vulnerabilities in the privatepublic overlap between BUSBY and Public Knowledge

PUBLIC

Ablon - 19

Busby
Ablon - 20

BUSBY finds zero-day vulnerabilities, and develops exploits for them

14
Year span (2002-2016)

207
Vulnerabilities and their exploits

64
Vendors

Data consists of information about vulnerability class, source code type, exploit class type, vendor, product, exploit developer,
and various dates (vulnerability discovery, exploit developed)
Ablon - 21

Data stats: three main types of vulnerabilities

Memory Corruption
110

Memory Mismanagement
41

Logic
67

Ablon - 22

Vulnerability Sub-Type: Memory Corruption

Type BSS Overflow Data overflow Heap Overflow Integer overflow Integer truncation Stack overflow Heap + Stack Heap + Integer

Count 1 1 58 2 2 40 1 1

23

Vulnerability Sub-Type: Memory Mismanagement

Type

Count

Remap memory

1

Information leak

4

Integer mismanagement

1

Invalid pointer dereference

2

Name validation

1

Null dereference

12

Out of bounds write

1

Privilege escalation

2

Reference count + object mismanagement

1

Type confusion + object mismanagement

1

Unsecure environment variables

1

Use after free

2

Use unverified supply pointer value

2

24

Vulnerability Sub-Type: Logic

Type API Misuse Authentication Bypass Auto execution Bypass Call-gate mismanagement Command injection Design misuse Directory traversal; input validation DNS Cache poisoning Environment insertion Executable file upload File normalization error

Count 3 5 1 1 2 3 1 1 1 1 1 1

Type File read primitive IO control based on write primitives Object injection / deserialization Permissions on kernel device Privilege issues: file read (1); mismanagement (2); spoofing (1) Race condition Reference count Register / memory mismanagement Remote code injection SQLi XSS

Count 2 1 4 1 4
20 3 1 1 1 1

25

Data stats: number of vulnerabilities per source code type

Closed

Open

Mix or N/A

123

74

10

Ablon - 26

Data stats: number of vulnerabilities found and exploited, by vendor

Microsoft
55
Apple
14

Linux
39
SUN/Oracle
11

Other
88
· 64 vendors total
· Others include: Mozilla, LinkSys, Google, Adobe, etc.
Ablon - 27

Data stats: number of exploits developed per exploit class type

Local

Client-side

Remote

76

25

71

Ablon - 28

Some other observations about the data

· 4% of the vulnerabilities in the dataset were purchased from an outside 3rd party

· Not all vulnerabilities were exploited

· CVEs do not always provide accurate and complete information about the severity of a vulnerability

· Virtual isolation (hypervisors or VMs) and anti-virus are not necessarily viable mitigations

· Other observations (graphs) . . .

Ablon - 29

Exploit development time is relatively short
Over 70% of exploits are developed in a month (31 days) or less 30

Mitigations have affected exploitability
(e.g., heap vs stack overflow)
Mitigations introduced c. 2007 caused a shift in type of buffer overflow explo3i1ted

Exploit development career lengths vary
Low hanging fruit may account for a higher number of exploits developed earl3y2 on

Exploit development career lengths vary
Low hanging fruit may account for a higher number of exploits developed earl3y3 on

We focus on characteristics of the vulnerabilities

Life Status
??

Longevity
· Survival Rate · Life Expectancy

Collision Rate

Ablon - 34

There are some caveats to our research
· Results from our research can be generalized only to similar datasets
· We are comparing private data to public data (ideal would be to compare multiple private datasets)
Ablon - 35

Life Status

Research Question: What are various "life stages" a zero-day vulnerability can be in?

Metric: What proportion of zero-day vulnerabilities are:

??

· Alive (publicly unknown / blue)

· Dead (publicly known / teal & green)

· Somewhere in between

Ablon - 36

Alive and dead are numbered about the same
There is more granularity to a vulnerability being either alive or dead 37

We found more granularity in life stages
Labeling a vulnerability as either alive or dead is misleading and too simplis3t8ic

About 1 in 6 of the alive are immortal
Labeling a vulnerability as either alive or dead is misleading and too simplis3t9ic

Patches killed most of the dead
Labeling a vulnerability as either alive or dead is misleading and too simplis4t0ic

Code revisions created a bunch of code refactored "zombies"
Labeling a vulnerability as either alive or dead is misleading and too simplis4t1ic

Longevity
Research Question: How long will a zero-day vulnerability remain undiscovered and undisclosed to the public?
Metrics: · What is a short and long life
for a zero-day vulnerability? · What is the average life
expectancy of a zero-day vulnerability and its exploit?
Ablon - 42

We borrowed a methodology from life insurers
· We do not know what is going to happen to those vulnerabilities that are still currently alive
· Calculating short life, long life, and average lifetimes requires taking into account alive vulnerabilities
· Kaplan-Meier analysis estimates the probability of surviving from some event of interest over time
· Ex: For humans, the probability of someone having a heart attack · For vulnerabilities, the probability of dying and becoming publicly
known
Ablon - 43

We plotted the survival probability of our data
Ablon - 44

75% lived longer than 1.5 years

25%
died before 1.5 years

25%
lived longer than 9.5 years

Ablon - 45

Average life expectancy is nearly 7 years

Average Life Expectancy: 6.9 years (Area under exponential curve)

Ablon - 46

Do certain characteristics indicate a long or short life?
· Vulnerability Type · Platform/Vendor
affected · Source Code · Exploit Class
47

Do certain characteristics indicate a long or short life?
· Vulnerability Type · Platform/Vendor
affected · Source Code · Exploit Class
Ablon - 48

Do certain characteristics indicate a long or short life?
· Vulnerability Type · Platform/Vendor
affected · Source Code · Exploit Class
49

Do certain characteristics indicate a long or short life?
· Vulnerability Type · Platform/Vendor
affected · Source Code · Exploit Class
50

Do certain characteristics indicate a long or short life?
· Vulnerability Type · Platform/Vendor
affected · Source Code · Exploit Class
51

Do certain characteristics indicate a long or short life?
It's unclear.
More data is needed to refine results.
52

Does life expectancy or survival probability change over time?
Does not appear so. Results not statistically significant to indicate a difference year by year.
More data could refine results.
53

Collision Rate
Research Question: What is the collision rate of zero-day vulnerabilities independently discovered and disclosed in a given time period?
Metric: What percentage of privately known vulnerabilities get independently rediscovered and publicly disclosed in a given time period?
Ablon - 54

Clarity about time intervals is important
Time interval: All (14 years)
40%

We examined various time intervals
· Choose a time interval (365 days, 90 days, 30 days, etc.)
· Over that time interval, new zero-day vulnerabilities are discovered and retained
· At the end of the time interval, examine how many have been found by others and publicly disclosed (i.e. died)
­ "Throw out" those that have died ­ Keep the ones that are still alive ­ Continue to discover and retain new ones until the end of the next
time interval when re-evaluation begins again
Collision rate: median percentage of those that died over all time Aibnlotne- 5r6vals

Clarity about time intervals is important

Time interval: 365-days
5.7%

Immortal Living Un-factored Code Refactor Factored Code Refactor Security Patch Publicly Shared Killed by BUSBY Unknown

Clarity about time intervals is important

Time interval: 90-days
0.87%

Immortal Living Un-factored Code Refactor Factored Code Refactor Security Patch Publicly Shared Killed by BUSBY Unknown

Meaning can be easily manipulated

Time interval: All (14 years)
40%

Time interval: 365-days
5.7%

Time interval: 90-days
0.87%

Collision rates change significantly depending on the interval time

We explored several other research paths

· Average life expectancies based on vulnerability characteristic* · Life expectancy variation based on birth year · Collision rate variation based on vulnerability characteristic* · Collision rate and timing for individual vulnerabilities · Time to develop exploit based on vulnerability characteristic * · Seasonality of vulnerability research · Cost of developing an exploit

*No statistical significance found, likely due to limited data

If you have data and would like to collaborate to refine this research,

please contact me: lablon@rand.org or @lilyablon

Ablon - 60

Life Status
7+ Categories
Labeling a zero-day vulnerability as either alive or dead can be misleading
and too simplistic

Key findings
Longevity
6.9 years
Zero-day vulnerabilities and their exploits have a rather long average
life expectancy

Collision Rate
5.7% per year
Time interval examined can significantly change the
percentage for likelihood of independent rediscovery

Report freely available at: http://www.rand.org/pubs/research_reports/RR1A7b5lon1-.6h1tml

Implications and recommendations of findings

For those defensively focused
· Refine tactical approaches:
· Analyze previous versions of code that are still in heavy use (e.g., ICS)
· Harness techniques of how offense finds vulnerabilities
· Seek better options to detect vulns
· Consider strategic approaches: mitigation, containment, accountability, and a robust infrastructure of patching
· Employ physical isolation · Account for software, devices, and
removable media · Incentivize upgrading to new versions

For those offensively focused
· Retain a few vulnerabilities per particular software package
· Consider immortal or code-refactored vulnerabilities for operations
· Regularly revisit vulnerabilities thought to be unexploitable
· Plan for a specific vulnerability only for short-term planning operations; expand to any vulnerability may extend the timeline
Ablon - 62

Our findings can help inform the retain vs. disclose discussions
Long average lifetimes and relatively low collision rates
may indicate that:
vulnerabilities are dense, or vulnerabilities are hard to find
Ablon - 63

Our findings can help inform the retain vs. disclose discussions
vulnerabilities are dense, or vulnerabilities are hard to find

Pro retention
· The level of protection from disclosing a vulnerability may be modest
· There is a small probability of re-discovery by others

Pro disclosure
· Collision rates for zero-day vulnerabilities are non-zero
· A non-zero probability (no matter how small) that someone else will find the same zero-day vulnerability may be too risky
Ablon - 64

Life Status
7+ Categories
Labeling a zero-day vulnerability as either alive or dead can be misleading
and too simplistic

Key findings
Longevity
6.9 years
Zero-day vulnerabilities and their exploits have a rather long average
life expectancy

Collision Rate
5.7% per year
Time interval examined can significantly change the
percentage for likelihood of independent rediscovery

Report freely available at: http://www.rand.org/pubs/research_reports/RR1A7b5lon1-.6h5tml

Thank you!
Lillian Ablon
lablon@rand.org @LilyAblon
Report freely available at: http://www.rand.org/pubs/research_reports/RR1751.html

