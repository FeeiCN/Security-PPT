iOS 

XcodeGhost
 XCodeApp  



 iOS   


iOS  






 iOS
 iOS 
 

iOS
0 Code Signing ASLR KASLR TouchID TeamID Kernel Integrity iPhoneOS 1.x iPhonOS 2.x iOS 4.3 iOS 6 iOS 7 iOS 8 iOS 9
iOS

iOS
0 Code Signing ASLR KASLR TouchID TeamID Kernel Integrity iPhoneOS 1.x iPhonOS 2.x iOS 4.3 iOS 6 iOS 7 iOS 8 iOS 9



 iOS
 iOS 
 


 Mach-O: iOS/OS X


 FAT Binary: CPUMach-O


 FAT Binary
 posix_spawn FAT binary CPU
 FAT headerarch




    LC_MAIN 
 dyld  dyldLC_UNIXTHREADdyld 
 dyld  dylddylib

iOS 8.2
 MachO  dyld MachOpage fault
   MachOdyld LC_UNIXTHREAD ROP 

iOS 8.3
 MachO 

load_machfile
K ern el
exec_mach_imgact

U serlan d

EXEC V

parse_machfile ubc_cs_blob_add

load_code_signature

mac_vnode_check_signature
A M F ID





Sha1

iOS 8.3-8.4
 SHA1 SHA1
 iOSpagesize SHA1
 pagesize SHA1iOS SHA1
SHA1
page SHA1 

iOS 8.3-8.4
   page

SHA1


 iOS iOS
 TOCTOU (Time of check to time of use)
 iOS0 

 Q&A

 Q&A

 Q&A

 Q&A

